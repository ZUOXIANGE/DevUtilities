<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="using:DevUtilities.ViewModels"
             mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="600"
             x:Class="DevUtilities.Views.UrlToolsView"
             x:DataType="vm:UrlToolsViewModel">
  
  <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto">
    <StackPanel Margin="24" Spacing="20">
      
      <!-- 标题 -->
      <TextBlock Text="URL工具集" FontSize="24" FontWeight="Bold" HorizontalAlignment="Center" Margin="0,0,0,10"/>
      
      <!-- URL输入区域 -->
      <Border Background="White" CornerRadius="8" Padding="16" BorderBrush="#E0E0E0" BorderThickness="1">
        <StackPanel Spacing="12">
          <TextBlock Text="URL输入" FontSize="16" FontWeight="SemiBold"/>
          <Grid RowDefinitions="Auto,10,Auto" ColumnDefinitions="*,10,Auto">
            
            <TextBox Grid.Row="0" Grid.Column="0" 
                     Text="{Binding InputUrl}" 
                     Watermark="输入URL地址"
                     HorizontalAlignment="Stretch"/>
            <Button Grid.Row="0" Grid.Column="2" 
                    Content="解析" 
                    Command="{Binding ParseUrlCommand}"/>
            
            <!-- 验证结果 -->
            <TextBlock Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="3"
                       Text="{Binding ValidationMessage}" 
                       Foreground="{Binding IsValidUrl, Converter={StaticResource BoolToColorConverter}}"
                       FontWeight="SemiBold"/>
          </Grid>
        </StackPanel>
      </Border>
      
      <!-- URL编码/解码 -->
      <Border Background="White" CornerRadius="8" Padding="16" BorderBrush="#E0E0E0" BorderThickness="1">
        <StackPanel Spacing="12">
          <TextBlock Text="URL编码/解码" FontSize="16" FontWeight="SemiBold"/>
          
          <!-- 编码类型选择 -->
          <Grid ColumnDefinitions="Auto,10,*">
            <TextBlock Grid.Column="0" Text="编码类型:" VerticalAlignment="Center"/>
            <ComboBox Grid.Column="2" 
                      ItemsSource="{Binding EncodingTypes}" 
                      SelectedItem="{Binding SelectedEncodingType}"
                      HorizontalAlignment="Stretch"/>
          </Grid>
          
          <!-- 操作按钮 -->
          <StackPanel Orientation="Horizontal" Spacing="10">
            <Button Content="编码" Command="{Binding EncodeUrlCommand}"/>
            <Button Content="解码" Command="{Binding DecodeUrlCommand}"/>
          </StackPanel>
          
          <!-- 编码结果 -->
          <StackPanel Spacing="8">
            <TextBlock Text="编码结果:" FontWeight="SemiBold"/>
            <TextBox Text="{Binding EncodedUrl}" 
                     IsReadOnly="True" 
                     TextWrapping="Wrap"
                     MinHeight="60"/>
          </StackPanel>
          
          <!-- 解码结果 -->
          <StackPanel Spacing="8">
            <TextBlock Text="解码结果:" FontWeight="SemiBold"/>
            <TextBox Text="{Binding DecodedUrl}" 
                     IsReadOnly="True" 
                     TextWrapping="Wrap"
                     MinHeight="60"/>
          </StackPanel>
        </StackPanel>
      </Border>
      
      <!-- URL解析结果 -->
      <Border Background="White" CornerRadius="8" Padding="16" BorderBrush="#E0E0E0" BorderThickness="1">
        <StackPanel Spacing="12">
          <TextBlock Text="URL解析结果" FontSize="16" FontWeight="SemiBold"/>
          
          <ListBox ItemsSource="{Binding UrlComponents}" 
                   MaxHeight="200"
                   ScrollViewer.VerticalScrollBarVisibility="Auto">
            <ListBox.ItemTemplate>
              <DataTemplate>
                <Grid ColumnDefinitions="150,*">
                  <TextBlock Grid.Column="0" 
                             Text="{Binding Name}" 
                             FontWeight="SemiBold"
                             VerticalAlignment="Top"/>
                  <TextBlock Grid.Column="1" 
                             Text="{Binding Value}" 
                             TextWrapping="Wrap"
                             VerticalAlignment="Top"/>
                </Grid>
              </DataTemplate>
            </ListBox.ItemTemplate>
          </ListBox>
        </StackPanel>
      </Border>
      
      <!-- URL构建器 -->
      <Border Background="White" CornerRadius="8" Padding="16" BorderBrush="#E0E0E0" BorderThickness="1">
        <StackPanel Spacing="12">
          <TextBlock Text="URL构建器" FontSize="16" FontWeight="SemiBold"/>
          
          <!-- 基础URL -->
          <Grid ColumnDefinitions="Auto,10,*">
            <TextBlock Grid.Column="0" Text="基础URL:" VerticalAlignment="Center"/>
            <TextBox Grid.Column="2" 
                     Text="{Binding BaseUrl}" 
                     HorizontalAlignment="Stretch"/>
          </Grid>
          
          <!-- 路径 -->
          <Grid ColumnDefinitions="Auto,10,*">
            <TextBlock Grid.Column="0" Text="路径:" VerticalAlignment="Center"/>
            <TextBox Grid.Column="2" 
                     Text="{Binding PathSegments}" 
                     HorizontalAlignment="Stretch"/>
          </Grid>
          
          <!-- 查询参数 -->
          <StackPanel Spacing="8">
            <Grid ColumnDefinitions="*,Auto,Auto">
              <TextBlock Grid.Column="0" Text="查询参数:" FontWeight="SemiBold"/>
              <Button Grid.Column="1" Content="添加参数" Command="{Binding AddQueryParameterCommand}" Margin="0,0,10,0"/>
              <Button Grid.Column="2" Content="从URL解析" Command="{Binding ParseQueryToParametersCommand}"/>
            </Grid>
            
            <ListBox ItemsSource="{Binding QueryParameters}" 
                     MaxHeight="150"
                     ScrollViewer.VerticalScrollBarVisibility="Auto">
              <ListBox.ItemTemplate>
                <DataTemplate>
                  <Grid ColumnDefinitions="*,10,*,10,Auto">
                    <TextBox Grid.Column="0" 
                             Text="{Binding Key}" 
                             Watermark="参数名"/>
                    <TextBox Grid.Column="2" 
                             Text="{Binding Value}" 
                             Watermark="参数值"/>
                    <Button Grid.Column="4" 
                            Content="删除" 
                            Command="{Binding $parent[ListBox].DataContext.RemoveQueryParameterCommand}"
                            CommandParameter="{Binding}"/>
                  </Grid>
                </DataTemplate>
              </ListBox.ItemTemplate>
            </ListBox>
          </StackPanel>
          
          <!-- 构建按钮和结果 -->
          <Button Content="构建URL" Command="{Binding BuildUrlCommand}" HorizontalAlignment="Left"/>
          
          <StackPanel Spacing="8">
            <TextBlock Text="构建结果:" FontWeight="SemiBold"/>
            <TextBox Text="{Binding BuiltUrl}" 
                     IsReadOnly="True" 
                     TextWrapping="Wrap"
                     MinHeight="40"/>
          </StackPanel>
        </StackPanel>
      </Border>
      
    </StackPanel>
  </ScrollViewer>
</UserControl>
