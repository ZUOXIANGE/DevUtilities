<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="using:DevUtilities.ViewModels"
             mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="450"
             x:Class="DevUtilities.Views.QrCodeView"
             x:DataType="vm:QrCodeViewModel">
  
  <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto">
    <StackPanel Margin="20" Spacing="20">
      
      <!-- 标题 -->
      <TextBlock Text="二维码工具" FontSize="24" FontWeight="Bold" HorizontalAlignment="Center" />
      
      <!-- 二维码生成区域 -->
      <Border BorderBrush="#E0E0E0" BorderThickness="1" CornerRadius="8" Padding="16">
        <StackPanel Spacing="12">
          <TextBlock Text="二维码生成" FontSize="18" FontWeight="SemiBold" />
          
          <!-- 输入文本 -->
          <StackPanel Spacing="8">
            <TextBlock Text="输入文本:" FontWeight="Medium" />
            <TextBox Text="{Binding InputText}" 
                     Watermark="请输入要生成二维码的文本..."
                     AcceptsReturn="True"
                     TextWrapping="Wrap"
                     MinHeight="80" />
          </StackPanel>
          
          <!-- 生成设置 -->
          <Grid ColumnDefinitions="*,*,*" RowDefinitions="Auto,Auto,Auto" Margin="0,8,0,0">
            <StackPanel Grid.Column="0" Spacing="4" Margin="0,0,8,0">
              <TextBlock Text="尺寸:" FontWeight="Medium" />
              <NumericUpDown Value="{Binding QrCodeSize}" 
                           Minimum="100" Maximum="800" 
                           Increment="50" />
            </StackPanel>
            
            <StackPanel Grid.Column="1" Spacing="4" Margin="8,0,8,0">
              <TextBlock Text="纠错级别:" FontWeight="Medium" />
              <ComboBox SelectedItem="{Binding SelectedErrorCorrection}">
                <ComboBoxItem Content="L (低)" />
                <ComboBoxItem Content="M (中)" />
                <ComboBoxItem Content="Q (高)" />
                <ComboBoxItem Content="H (最高)" />
              </ComboBox>
            </StackPanel>
            
            <StackPanel Grid.Column="2" Spacing="4" Margin="8,0,0,0">
              <TextBlock Text="编码:" FontWeight="Medium" />
              <ComboBox SelectedItem="{Binding SelectedEncoding}">
                <ComboBoxItem Content="UTF-8" />
                <ComboBoxItem Content="GBK" />
                <ComboBoxItem Content="ASCII" />
              </ComboBox>
            </StackPanel>
            
            <CheckBox Grid.Column="0" Grid.Row="1" Grid.ColumnSpan="2"
                     IsChecked="{Binding IncludeQuietZone}"
                     Content="包含静默区域"
                     Margin="0,8,0,0" />
          </Grid>
          
          <!-- 操作按钮 -->
          <StackPanel Orientation="Horizontal" Spacing="8" Margin="0,8,0,0">
            <Button Content="生成二维码" Command="{Binding GenerateQrCodeCommand}" />
            <Button Content="清空" Command="{Binding ClearAllCommand}" />
            <Button Content="保存图片" Command="{Binding SaveImageCommand}" />
            <Button Content="使用示例" Command="{Binding UseExampleCommand}" />
          </StackPanel>
          
          <!-- 验证消息 -->
          <TextBlock Text="{Binding ValidationMessage}" 
                     Foreground="Red" 
                     IsVisible="{Binding !IsValidInput}" />
        </StackPanel>
      </Border>
      
      <!-- 二维码显示区域 -->
      <Border BorderBrush="#E0E0E0" BorderThickness="1" CornerRadius="8" Padding="16">
        <StackPanel Spacing="12">
          <TextBlock Text="生成的二维码" FontSize="18" FontWeight="SemiBold" />
          
          <Border BorderBrush="#CCCCCC" BorderThickness="1" 
                  Background="White" 
                  HorizontalAlignment="Center"
                  VerticalAlignment="Center"
                  MinWidth="320" MinHeight="320">
            <Image Source="{Binding QrCodeImage}" 
                   Stretch="Uniform"
                   HorizontalAlignment="Center"
                   VerticalAlignment="Center" />
          </Border>
        </StackPanel>
      </Border>
      
      <!-- 二维码识别区域 -->
      <Border BorderBrush="#E0E0E0" BorderThickness="1" CornerRadius="8" Padding="16">
        <StackPanel Spacing="12">
          <TextBlock Text="二维码识别" FontSize="18" FontWeight="SemiBold" />
          
          <!-- 文件选择 -->
          <StackPanel Orientation="Horizontal" Spacing="8">
            <Button Content="加载图片" Command="{Binding LoadImageCommand}" />
            <Button Content="复制解码文本" Command="{Binding CopyDecodedTextCommand}" />
          </StackPanel>
          
          <!-- 识别结果 -->
          <StackPanel Spacing="8">
            <TextBlock Text="识别结果:" FontWeight="Medium" />
            <TextBox Text="{Binding DecodedText}" 
                     IsReadOnly="True"
                     AcceptsReturn="True"
                     TextWrapping="Wrap"
                     MinHeight="80" />
            <StackPanel Orientation="Horizontal" Spacing="8">
              <Button Content="复制结果" Command="{Binding CopyDecodedTextCommand}" />
            </StackPanel>
          </StackPanel>
        </StackPanel>
      </Border>
      
      <!-- 批量处理 -->
      <Border BorderBrush="#E0E0E0" BorderThickness="1" CornerRadius="8" Padding="16">
        <StackPanel Spacing="12">
          <TextBlock Text="批量处理" FontSize="18" FontWeight="SemiBold" />
          
          <StackPanel Orientation="Horizontal" Spacing="8">
            <!-- 批量处理功能暂时移除，因为ViewModel中没有对应的命令 -->
          </StackPanel>
        </StackPanel>
      </Border>
      
      <!-- 使用说明 -->
      <Border BorderBrush="#E0E0E0" BorderThickness="1" CornerRadius="8" Padding="16">
        <StackPanel Spacing="8">
          <TextBlock Text="使用说明" FontSize="16" FontWeight="SemiBold" />
          <TextBlock TextWrapping="Wrap">
            <Run Text="1. 在文本框中输入要生成二维码的内容" />
            <LineBreak />
            <Run Text="2. 调整二维码尺寸、纠错级别和编码格式" />
            <LineBreak />
            <Run Text="3. 点击&quot;生成二维码&quot;按钮创建二维码" />
            <LineBreak />
            <Run Text="4. 可以保存或复制生成的二维码图片" />
            <LineBreak />
            <Run Text="5. 选择图片文件或从剪贴板粘贴图片进行识别" />
            <LineBreak />
            <Run Text="6. 支持批量生成和识别功能" />
          </TextBlock>
        </StackPanel>
      </Border>
      
    </StackPanel>
  </ScrollViewer>
</UserControl>
