<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:DevUtilities.ViewModels"
             xmlns:converters="using:DevUtilities.Converters"
             x:Class="DevUtilities.Views.CryptoToolsView"
             x:DataType="vm:CryptoToolsViewModel">

  <UserControl.Resources>
    <converters:BooleanToColorConverter x:Key="BoolToColorConverter" />
    <converters:StringIsNotNullOrEmptyConverter x:Key="StringToBoolConverter" />
  </UserControl.Resources>

  <ScrollViewer>
    <StackPanel Margin="20" Spacing="20">
      
      <!-- 标题 -->
      <TextBlock Text="加密工具" FontSize="24" FontWeight="Bold" HorizontalAlignment="Center" />
      
      <!-- 对称加密区域 -->
      <Border BorderBrush="#E0E0E0" BorderThickness="1" CornerRadius="8" Padding="16">
        <StackPanel Spacing="12">
          <TextBlock Text="对称加密" FontSize="18" FontWeight="SemiBold" />
          
          <!-- 算法选择 -->
          <Grid ColumnDefinitions="*,*,*,*" RowDefinitions="Auto,Auto" Margin="0,8">
            <StackPanel Grid.Column="0" Spacing="4">
              <TextBlock Text="加密算法:" FontWeight="Medium" />
              <ComboBox ItemsSource="{Binding AvailableAlgorithms}" 
                       SelectedItem="{Binding SelectedAlgorithm}" 
                       Width="120" />
            </StackPanel>
            
            <StackPanel Grid.Column="1" Spacing="4">
              <TextBlock Text="加密模式:" FontWeight="Medium" />
              <ComboBox ItemsSource="{Binding AvailableModes}" 
                       SelectedItem="{Binding SelectedMode}" 
                       Width="120" />
            </StackPanel>
            
            <StackPanel Grid.Column="2" Spacing="4">
              <TextBlock Text="填充模式:" FontWeight="Medium" />
              <ComboBox ItemsSource="{Binding AvailablePaddings}" 
                       SelectedItem="{Binding SelectedPadding}" 
                       Width="120" />
            </StackPanel>
            
            <StackPanel Grid.Column="3" Spacing="4">
              <TextBlock Text="编码格式:" FontWeight="Medium" />
              <ComboBox ItemsSource="{Binding AvailableEncodings}" 
                       SelectedItem="{Binding SelectedEncoding}" 
                       Width="120" />
            </StackPanel>
          </Grid>
          
          <!-- 密钥和IV -->
          <Grid ColumnDefinitions="*,Auto,*,Auto" Margin="0,8">
            <StackPanel Grid.Column="0" Spacing="4">
              <TextBlock Text="密钥 (Hex):" FontWeight="Medium" />
              <TextBox Text="{Binding KeyText}" 
                      Watermark="输入十六进制密钥" 
                      FontFamily="Consolas" />
            </StackPanel>
            
            <Button Grid.Column="1" Content="生成" 
                   Command="{Binding GenerateRandomKeyCommand}" 
                   Margin="8,20,8,0" 
                   VerticalAlignment="Top" />
            
            <StackPanel Grid.Column="2" Spacing="4">
              <TextBlock Text="初始向量 IV (Hex):" FontWeight="Medium" />
              <TextBox Text="{Binding IvText}" 
                      Watermark="输入十六进制IV" 
                      FontFamily="Consolas" />
            </StackPanel>
            
            <Button Grid.Column="3" Content="生成" 
                   Command="{Binding GenerateRandomIVCommand}" 
                   Margin="8,20,8,0" 
                   VerticalAlignment="Top" />
          </Grid>
          
          <!-- 输入输出区域 -->
          <Grid ColumnDefinitions="*,Auto,*" Margin="0,8">
            <StackPanel Grid.Column="0" Spacing="4">
              <TextBlock Text="输入文本:" FontWeight="Medium" />
              <TextBox Text="{Binding InputText}" 
                      AcceptsReturn="True" 
                      TextWrapping="Wrap" 
                      Height="120" 
                      ScrollViewer.VerticalScrollBarVisibility="Auto"
                      Watermark="输入要加密/解密的文本" />
            </StackPanel>
            
            <StackPanel Grid.Column="1" Spacing="8" Margin="16,20,16,0" VerticalAlignment="Top">
              <Button Content="加密 →" Command="{Binding EncryptCommand}" Width="80" />
              <Button Content="解密 →" Command="{Binding DecryptCommand}" Width="80" />
              <Button Content="交换" Command="{Binding SwapInputOutputCommand}" Width="80" />
            </StackPanel>
            
            <StackPanel Grid.Column="2" Spacing="4">
              <StackPanel Orientation="Horizontal" Spacing="8">
                <TextBlock Text="输出结果:" FontWeight="Medium" />
                <Button Content="复制" Command="{Binding CopyOutputCommand}" 
                       IsEnabled="{Binding OutputText, Converter={StaticResource StringToBoolConverter}}" />
              </StackPanel>
              <TextBox Text="{Binding OutputText}" 
                      AcceptsReturn="True" 
                      TextWrapping="Wrap" 
                      Height="120" 
                      IsReadOnly="True"
                      ScrollViewer.VerticalScrollBarVisibility="Auto"
                      FontFamily="Consolas" />
            </StackPanel>
          </Grid>
        </StackPanel>
      </Border>
      
      <!-- 哈希计算区域 -->
      <Border BorderBrush="#E0E0E0" BorderThickness="1" CornerRadius="8" Padding="16">
        <StackPanel Spacing="12">
          <TextBlock Text="哈希计算" FontSize="18" FontWeight="SemiBold" />
          
          <Grid ColumnDefinitions="*,Auto,*,Auto" Margin="0,8">
            <StackPanel Grid.Column="0" Spacing="4">
              <TextBlock Text="哈希算法:" FontWeight="Medium" />
              <ComboBox ItemsSource="{Binding AvailableHashAlgorithms}" 
                       SelectedItem="{Binding SelectedHashAlgorithm}" 
                       Width="120" />
            </StackPanel>
            
            <Button Grid.Column="1" Content="计算哈希" 
                   Command="{Binding ComputeHashCommand}" 
                   Margin="16,20,16,0" 
                   VerticalAlignment="Top" />
            
            <StackPanel Grid.Column="2" Spacing="4">
              <StackPanel Orientation="Horizontal" Spacing="8">
                <TextBlock Text="哈希值:" FontWeight="Medium" />
                <Button Content="复制" Command="{Binding CopyHashCommand}" 
                       IsEnabled="{Binding HashOutput, Converter={StaticResource StringToBoolConverter}}" />
              </StackPanel>
              <TextBox Text="{Binding HashOutput}" 
                      IsReadOnly="True" 
                      FontFamily="Consolas"
                      Watermark="哈希值将显示在这里" />
            </StackPanel>
          </Grid>
        </StackPanel>
      </Border>
      
      <!-- HMAC计算区域 -->
      <Border BorderBrush="#E0E0E0" BorderThickness="1" CornerRadius="8" Padding="16">
        <StackPanel Spacing="12">
          <TextBlock Text="HMAC计算" FontSize="18" FontWeight="SemiBold" />
          
          <Grid ColumnDefinitions="*,Auto,*,Auto" Margin="0,8">
            <StackPanel Grid.Column="0" Spacing="4">
              <TextBlock Text="HMAC密钥:" FontWeight="Medium" />
              <TextBox Text="{Binding HmacKey}" 
                      Watermark="输入HMAC密钥" />
            </StackPanel>
            
            <Button Grid.Column="1" Content="计算HMAC" 
                   Command="{Binding ComputeHmacCommand}" 
                   Margin="16,20,16,0" 
                   VerticalAlignment="Top" />
            
            <StackPanel Grid.Column="2" Spacing="4">
              <StackPanel Orientation="Horizontal" Spacing="8">
                <TextBlock Text="HMAC值:" FontWeight="Medium" />
                <Button Content="复制" Command="{Binding CopyHmacCommand}" 
                       IsEnabled="{Binding HmacOutput, Converter={StaticResource StringToBoolConverter}}" />
              </StackPanel>
              <TextBox Text="{Binding HmacOutput}" 
                      IsReadOnly="True" 
                      FontFamily="Consolas"
                      Watermark="HMAC值将显示在这里" />
            </StackPanel>
          </Grid>
        </StackPanel>
      </Border>
      
      <!-- 控制按钮 -->
      <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Spacing="16">
        <Button Content="清空所有" Command="{Binding ClearAllCommand}" />
      </StackPanel>
      
      <!-- 验证消息 -->
      <TextBlock Text="{Binding ValidationMessage}" 
                HorizontalAlignment="Center" 
                FontWeight="Medium"
                Foreground="{Binding IsValidInput, Converter={StaticResource BoolToColorConverter}}" />
      
      <!-- 使用说明 -->
      <Border BorderBrush="#E0E0E0" BorderThickness="1" CornerRadius="8" Padding="16" Background="#F9F9F9">
        <StackPanel Spacing="8">
          <TextBlock Text="使用说明:" FontWeight="SemiBold" />
          <TextBlock TextWrapping="Wrap">
            <Run Text="• 对称加密：支持AES、DES、TripleDES、RC2算法" />
            <LineBreak />
            <Run Text="• 加密模式：CBC、ECB、CFB、OFB" />
            <LineBreak />
            <Run Text="• 填充模式：PKCS7、Zeros、None" />
            <LineBreak />
            <Run Text="• 哈希算法：MD5、SHA1、SHA256、SHA384、SHA512" />
            <LineBreak />
            <Run Text="• HMAC：基于哈希的消息认证码" />
            <LineBreak />
            <Run Text="• 密钥和IV使用十六进制格式，可点击生成按钮自动生成" />
            <LineBreak />
            <Run Text="• 加密输出为十六进制格式，解密时请确保输入为十六进制" />
          </TextBlock>
        </StackPanel>
      </Border>
      
    </StackPanel>
  </ScrollViewer>
  
</UserControl>