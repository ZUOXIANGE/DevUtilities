<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:DevUtilities.ViewModels"
             x:Class="DevUtilities.Views.JsonFormatterView"
             x:DataType="vm:JsonFormatterViewModel">

  <Design.DataContext>
    <vm:JsonFormatterViewModel/>
  </Design.DataContext>

  <ScrollViewer>
    <StackPanel Margin="20" Spacing="20">
      
      <!-- 标题区域 -->
      <StackPanel Spacing="6">
        <SelectableTextBlock Text="JSON格式化器" 
                   FontSize="26" 
                   FontWeight="Bold" 
                   Foreground="{DynamicResource SystemAccentColor}"/>
        <SelectableTextBlock Text="JSON格式化、验证和美化工具" 
                   FontSize="14" 
                   Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}"/>
      </StackPanel>

      <!-- 格式化选项区域 -->
      <Border Background="{DynamicResource SystemControlBackgroundAltHighBrush}" 
              CornerRadius="8" 
              Padding="16">
        <StackPanel Spacing="12">
          <SelectableTextBlock Text="格式化选项" FontWeight="SemiBold" FontSize="16"/>
          
          <Grid ColumnDefinitions="*,*,*" RowDefinitions="Auto,Auto">
            <!-- 缩进设置 -->
            <StackPanel Grid.Column="0" Grid.Row="0" Spacing="6" Margin="0,0,10,0">
              <SelectableTextBlock Text="缩进大小"/>
              <ComboBox SelectedIndex="1" HorizontalAlignment="Stretch">
                <ComboBoxItem Content="2个空格"/>
                <ComboBoxItem Content="4个空格"/>
                <ComboBoxItem Content="Tab缩进"/>
              </ComboBox>
            </StackPanel>
            
            <!-- 排序选项 -->
            <StackPanel Grid.Column="1" Grid.Row="0" Spacing="8" Margin="10,0,10,0">
              <CheckBox Content="排序属性" IsChecked="{Binding SortProperties}"/>
              <CheckBox Content="移除空白字符"/>
              <CheckBox Content="转义Unicode"/>
            </StackPanel>
            
            <!-- 验证选项 -->
            <StackPanel Grid.Column="2" Grid.Row="0" Spacing="8" Margin="10,0,0,0">
              <CheckBox Content="严格验证"/>
              <CheckBox Content="允许注释"/>
              <CheckBox Content="允许尾随逗号"/>
            </StackPanel>
          </Grid>
        </StackPanel>
      </Border>

      <!-- 输入输出区域 -->
      <Grid ColumnDefinitions="*,20,*" RowDefinitions="Auto,*">
        
        <!-- 输入区域 -->
        <StackPanel Grid.Column="0" Grid.Row="0" Grid.RowSpan="2" Spacing="8">
          <SelectableTextBlock Text="JSON输入" FontWeight="SemiBold" FontSize="16"/>
          <Border Background="{DynamicResource SystemControlBackgroundAltHighBrush}" 
                  CornerRadius="8" 
                  Padding="12"
                  Height="400">
            <Grid RowDefinitions="*,Auto">
              <TextBox Grid.Row="0"
                      Text="{Binding InputText}" 
                      AcceptsReturn="True" 
                      TextWrapping="Wrap"
                      FontFamily="Consolas"
                      FontSize="13"
                      Background="Transparent"
                      BorderThickness="0"
                      Watermark="在此输入JSON数据..."/>
              
              <!-- 输入区域按钮 -->
              <StackPanel Grid.Row="1" Orientation="Horizontal" Spacing="8" Margin="0,8,0,0">
                <Button Content="粘贴" Command="{Binding CopyCommand}" Classes="accent"/>
                <Button Content="清空" Command="{Binding ClearCommand}"/>
                <Button Content="从文件加载" Command="{Binding FormatCommand}"/>
                <Button Content="示例JSON" Command="{Binding ValidateCommand}"/>
              </StackPanel>
            </Grid>
          </Border>
        </StackPanel>

        <!-- 分隔符 -->
        <Border Grid.Column="1" Grid.Row="0" Grid.RowSpan="2" 
                Background="{DynamicResource SystemControlForegroundBaseLowBrush}" 
                Width="1" 
                Margin="0,30,0,0"/>

        <!-- 输出区域 -->
        <StackPanel Grid.Column="2" Grid.Row="0" Grid.RowSpan="2" Spacing="8">
          <SelectableTextBlock Text="格式化输出" FontWeight="SemiBold" FontSize="16"/>
          <Border Background="{DynamicResource SystemControlBackgroundAltHighBrush}" 
                  CornerRadius="8" 
                  Padding="12"
                  Height="400">
            <Grid RowDefinitions="*,Auto">
              <TextBox Grid.Row="0"
                      Text="{Binding OutputText}" 
                      AcceptsReturn="True" 
                      TextWrapping="Wrap"
                      FontFamily="Consolas"
                      FontSize="13"
                      Background="Transparent"
                      BorderThickness="0"
                      IsReadOnly="True"
                      Watermark="格式化结果将显示在这里..."/>
              
              <!-- 输出区域按钮 -->
              <StackPanel Grid.Row="1" Orientation="Horizontal" Spacing="8" Margin="0,8,0,0">
                <Button Content="复制" Command="{Binding CopyCommand}" Classes="accent"/>
                <Button Content="保存" Command="{Binding FormatCommand}"/>
                <Button Content="压缩" Command="{Binding MinifyJsonCommand}"/>
                <Button Content="验证" Command="{Binding ValidateCommand}"/>
              </StackPanel>
            </Grid>
          </Border>
        </StackPanel>
      </Grid>

      <!-- 格式化按钮 -->
      <Button Content="🚀 格式化JSON" 
              Command="{Binding FormatCommand}" 
              HorizontalAlignment="Center"
              Classes="accent"
              FontSize="16"
              Padding="24,12"
              ToolTip.Tip="格式化JSON (Ctrl+F)"/>

      <!-- 快速操作区域 -->
      <Border Background="{DynamicResource SystemControlBackgroundAltHighBrush}" 
              CornerRadius="8" 
              Padding="16">
        <StackPanel Spacing="12">
          <SelectableTextBlock Text="快速操作" FontWeight="SemiBold" FontSize="16"/>
          
          <WrapPanel Orientation="Horizontal" ItemWidth="180" ItemHeight="40">
            <Button Content="美化JSON" Command="{Binding BeautifyJsonCommand}" 
                   HorizontalAlignment="Stretch" Margin="4"/>
            <Button Content="压缩JSON" Command="{Binding MinifyJsonCommand}" 
                   HorizontalAlignment="Stretch" Margin="4"/>
            <Button Content="验证JSON" Command="{Binding ValidateCommand}" 
                   HorizontalAlignment="Stretch" Margin="4"/>
            <Button Content="排序属性" Command="{Binding SortJsonPropertiesCommand}" 
                   HorizontalAlignment="Stretch" Margin="4"/>
            <Button Content="移除注释" Command="{Binding MinifyJsonCommand}" 
                   HorizontalAlignment="Stretch" Margin="4"/>
            <Button Content="转义字符" Command="{Binding BeautifyJsonCommand}" 
                   HorizontalAlignment="Stretch" Margin="4"/>
          </WrapPanel>
        </StackPanel>
      </Border>

      <!-- JSON工具区域 -->
      <Border Background="{DynamicResource SystemControlBackgroundAltHighBrush}" 
              CornerRadius="8" 
              Padding="16">
        <StackPanel Spacing="12">
          <SelectableTextBlock Text="JSON工具" FontWeight="SemiBold" FontSize="16"/>
          
          <Grid ColumnDefinitions="*,*,*" RowDefinitions="Auto,Auto">
            <!-- 路径查询 -->
            <StackPanel Grid.Column="0" Grid.Row="0" Spacing="6" Margin="0,0,10,0">
              <SelectableTextBlock Text="JSONPath查询"/>
              <TextBox Watermark="$.store.book[0].title" FontFamily="Consolas"/>
              <Button Content="查询" HorizontalAlignment="Stretch"/>
            </StackPanel>
            
            <!-- 数据统计 -->
            <StackPanel Grid.Column="1" Grid.Row="0" Spacing="6" Margin="10,0,10,0">
              <SelectableTextBlock Text="数据统计"/>
              <SelectableTextBlock Text="对象: 0 | 数组: 0" FontFamily="Consolas" FontSize="12"/>
              <SelectableTextBlock Text="字符: 0 | 行数: 0" FontFamily="Consolas" FontSize="12"/>
            </StackPanel>
            
            <!-- 转换工具 -->
            <StackPanel Grid.Column="2" Grid.Row="0" Spacing="6" Margin="10,0,0,0">
              <SelectableTextBlock Text="格式转换"/>
              <Button Content="转为XML" HorizontalAlignment="Stretch"/>
              <Button Content="转为YAML" HorizontalAlignment="Stretch"/>
            </StackPanel>
          </Grid>
        </StackPanel>
      </Border>

      <!-- 文件操作区域 -->
      <Border Background="{DynamicResource SystemControlBackgroundAltHighBrush}" 
              CornerRadius="8" 
              Padding="16">
        <StackPanel Spacing="12">
          <SelectableTextBlock Text="文件操作" FontWeight="SemiBold" FontSize="16"/>
          
          <WrapPanel Orientation="Horizontal" ItemWidth="150" ItemHeight="35">
            <Button Content="选择文件" Command="{Binding ClearCommand}" 
                   HorizontalAlignment="Stretch" Margin="4"/>
            <Button Content="加载文件" Command="{Binding FormatCommand}" 
                   HorizontalAlignment="Stretch" Margin="4"/>
            <Button Content="保存文件" Command="{Binding CopyCommand}" 
                   HorizontalAlignment="Stretch" Margin="4"/>
            <Button Content="批量处理" Command="{Binding ValidateCommand}" 
                   HorizontalAlignment="Stretch" Margin="4"/>
            <Button Content="导出报告" Command="{Binding SortJsonPropertiesCommand}" 
                   HorizontalAlignment="Stretch" Margin="4"/>
            <Button Content="比较JSON" Command="{Binding MinifyJsonCommand}" 
                   HorizontalAlignment="Stretch" Margin="4"/>
          </WrapPanel>
        </StackPanel>
      </Border>

      <!-- 错误信息显示 -->
      <Border Background="{DynamicResource SystemFillColorCriticalBrush}" 
              CornerRadius="8" 
              Padding="12"
              IsVisible="{Binding HasError}">
        <StackPanel Spacing="8">
          <SelectableTextBlock Text="错误信息" FontWeight="SemiBold" Foreground="White"/>
          <TextBox Text="{Binding ErrorMessage}" 
                  IsReadOnly="True" 
                  Background="Transparent"
                  BorderThickness="0"
                  Foreground="White"
                  TextWrapping="Wrap"/>
        </StackPanel>
      </Border>

      <!-- 使用说明 -->
      <Expander Header="使用说明" IsExpanded="False">
        <Border Background="{DynamicResource SystemControlBackgroundAltHighBrush}" 
                CornerRadius="8" 
                Padding="16">
          <StackPanel Spacing="8">
            <SelectableTextBlock Text="基本功能：" FontWeight="SemiBold"/>
            <SelectableTextBlock Text="• 格式化和美化JSON数据" TextWrapping="Wrap"/>
            <SelectableTextBlock Text="• 验证JSON语法的正确性" TextWrapping="Wrap"/>
            <SelectableTextBlock Text="• 压缩JSON以减少文件大小" TextWrapping="Wrap"/>
            
            <SelectableTextBlock Text="高级功能：" FontWeight="SemiBold" Margin="0,12,0,0"/>
            <SelectableTextBlock Text="• JSONPath查询和数据提取" TextWrapping="Wrap"/>
            <SelectableTextBlock Text="• 属性排序和结构优化" TextWrapping="Wrap"/>
            <SelectableTextBlock Text="• 批量文件处理和格式转换" TextWrapping="Wrap"/>
            
            <SelectableTextBlock Text="快捷键：" FontWeight="SemiBold" Margin="0,12,0,0"/>
            <SelectableTextBlock Text="• Ctrl+F: 格式化JSON" TextWrapping="Wrap"/>
            <SelectableTextBlock Text="• Ctrl+V: 粘贴内容" TextWrapping="Wrap"/>
            <SelectableTextBlock Text="• Ctrl+C: 复制结果" TextWrapping="Wrap"/>
          </StackPanel>
        </Border>
      </Expander>

    </StackPanel>
  </ScrollViewer>
</UserControl>
