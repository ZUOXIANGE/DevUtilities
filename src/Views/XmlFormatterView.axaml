<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="using:DevUtilities.ViewModels"
             xmlns:converters="using:DevUtilities.Converters"
             mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="450"
             x:Class="DevUtilities.Views.XmlFormatterView"
             x:DataType="vm:XmlFormatterViewModel">
  
  <ScrollViewer>
    <StackPanel Margin="20" Spacing="20">
      
      <!-- 标题 -->
      <TextBlock Text="XML格式化器" 
                 FontSize="24" 
                 FontWeight="Bold" 
                 HorizontalAlignment="Center"/>
      
      <!-- 输入区域 -->
      <StackPanel Spacing="10">
        <TextBlock Text="输入XML内容:" FontWeight="SemiBold"/>
        <Grid RowDefinitions="Auto,*" ColumnDefinitions="*,Auto,Auto">
          <TextBox Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="3"
                   Text="{Binding InputText}"
                   Watermark="{Binding InputPlaceholder}"
                   AcceptsReturn="True"
                   TextWrapping="Wrap"
                   Height="200"
                   ScrollViewer.VerticalScrollBarVisibility="Auto"/>
          
          <Button Grid.Row="0" Grid.Column="1" 
                  Content="清空" 
                  Command="{Binding ClearCommand}"
                  Margin="5,0,0,5"/>
          
          <Button Grid.Row="0" Grid.Column="2" 
                  Content="示例" 
                  Command="{Binding UseExampleCommand}"
                  Margin="5,0,0,5"/>
        </Grid>
      </StackPanel>
      
      <!-- 格式化选项 -->
      <StackPanel Spacing="10">
        <TextBlock Text="格式化选项:" FontWeight="SemiBold"/>
        <Grid RowDefinitions="Auto,Auto" ColumnDefinitions="*,*,*">
          <!-- 第一行选项 -->
          <CheckBox Grid.Row="0" Grid.Column="0" 
                    Content="移除注释" 
                    IsChecked="{Binding RemoveComments}"/>
          
          <CheckBox Grid.Row="0" Grid.Column="1" 
                    Content="移除空白字符" 
                    IsChecked="{Binding RemoveWhitespace}"
                    Margin="20,0,0,0"/>
          
          <CheckBox Grid.Row="0" Grid.Column="2" 
                    Content="缩进大小" 
                    Margin="20,0,0,0"/>
          
          <!-- 第二行选项 -->
          <CheckBox Grid.Row="1" Grid.Column="0" 
                    Content="排序属性" 
                    IsChecked="{Binding SortAttributes}"
                    Margin="0,10,0,0"/>
          
          <CheckBox Grid.Row="1" Grid.Column="1" 
                    Content="验证XML" 
                    Margin="20,10,0,0"/>
          
          <CheckBox Grid.Row="1" Grid.Column="2" 
                    Content="显示行号" 
                    Margin="20,10,0,0"/>
        </Grid>
      </StackPanel>
      
      <!-- 操作按钮 -->
      <StackPanel Orientation="Horizontal" Spacing="10" HorizontalAlignment="Center">
        <Button Content="格式化" 
                Command="{Binding FormatCommand}"
                Background="DodgerBlue"
                Foreground="White"
                Padding="20,8"/>
        
        <Button Content="压缩" 
                Command="{Binding CompressCommand}"
                Padding="20,8"/>
        
        <Button Content="验证" 
                Command="{Binding ValidateCommand}"
                Padding="20,8"/>
        
        <Button Content="交换" 
                Command="{Binding SwapInputOutputCommand}"
                Padding="20,8"/>
      </StackPanel>
      
      <!-- 输出区域 -->
      <StackPanel Spacing="10">
        <TextBlock Text="格式化结果:" FontWeight="SemiBold"/>
        <Grid RowDefinitions="Auto,*" ColumnDefinitions="*,Auto">
          <TextBox Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2"
                   Text="{Binding OutputText}"
                   Watermark="{Binding OutputPlaceholder}"
                   AcceptsReturn="True"
                   TextWrapping="Wrap"
                   IsReadOnly="True"
                   Height="200"
                   ScrollViewer.VerticalScrollBarVisibility="Auto"/>
          
          <Button Grid.Row="0" Grid.Column="1" 
                  Content="复制" 
                  Command="{Binding CopyCommand}"
                  Margin="5,0,0,5"/>
        </Grid>
      </StackPanel>
      
      <!-- 验证消息显示 -->
      <Border Background="LightBlue" 
              CornerRadius="5" 
              Padding="10"
              IsVisible="{Binding ValidationMessage, Converter={x:Static converters:StringConverters.IsNotNullOrEmpty}}">
        <TextBlock Text="{Binding ValidationMessage}" 
                   Foreground="DarkBlue" 
                   TextWrapping="Wrap"/>
      </Border>
      
      <!-- 错误信息显示 -->
      <Border Background="LightCoral" 
              CornerRadius="5" 
              Padding="10"
              IsVisible="{Binding HasError}">
        <TextBlock Text="{Binding ErrorMessage}" 
                   Foreground="White" 
                   TextWrapping="Wrap"/>
      </Border>
      
      <!-- 加载指示器 -->
      <ProgressBar IsIndeterminate="True" 
                   IsVisible="{Binding IsLoading}"
                   Height="4"/>
      
    </StackPanel>
  </ScrollViewer>
  
</UserControl>
